# stack-pozo
Código relacionado con la adquisición de datos de datos del sensor ultrasónico de distancia Milesight EM500-UDL del proyecto **SINERGEX** del [Centro de Investigaciones Científicas y Tecnológicas de Extremadura](http://cicytex.juntaex.es/es/) (Junta de Extremadura) desarrollado en su centro dependiente [Instituto del Corcho, la Madera y el Carbón Vegetal](http://cicytex.juntaex.es/es/centros/icmc).  

En el ámbito del proyecto SINERGEX se han instalado 32 sensores o actuadores con conectividad LoRaWAN<sup>TM</sup> para la monitorización y manejo de un cultivo irrigado de alcornoque. Servirá de parcela demostrativa y también de infraestructura tecnológica para dar soporte a proyectos futuros que necesiten alcornoques ya establecidos en régimen irrigado.  
Esta parcela, que cuenta con 176 árboles, está dotada de un sistema de sensores para controlar de forma remota los distintos aportes de agua. A partir del tercer año, 14 árboles se han seleccionado para su monitorización individual, de forma que el suministro de agua se adaptará a cada uno de ellos en función de sus necesidades. Este sistema permite recoger datos de un conjunto de parámetros relativos al crecimiento del árbol, que se volcarán de forma automática y centralizada. Paralelamente, desde el punto de vista energético, se ha trabajado en el estudio del uso de energía solar para riego con el objetivo de poder transferir ese conocimiento a los posibles interesados en establecer este tipo de cultivo en sus explotaciones.  
Este es un repositorio de ejemplo que contiene una muestra de código para configurar los distintos servicios que permiten llevar el parámetro físico de "altura de lámina de agua en cm" en un pozo artesano del que se extrae el agua de riego del proyecto hasta un escritorio de [Grafana](https://grafana.com/oss/grafana/).  
La lectura del parámetro se realiza con una sonda Milesight EM500-UDL situada a 6 metros desde el fondo del pozo. Envía datos de distancia hasta el agua en cm y porcentaje de batería restante a través de una red LoRaWAN. La red LoRaWAN está resulta con la pila de aplicaciones ChirpStack en su versión 3.x con integración para todas las aplicaciones en PostgreSQL 14.x.  
En PostgreSQL se ha creado una vista no materializada para un usuario con derechos 'SELECT'.  
En Grafana se ha configurado el acceso a esta base de datos y los paneles relacionados con la sonda de pozo utilizan las vistas creadas.  


